var jsVideoViewer360=function(t){this.video=null,this.options={el:null,fps:12,frames:24,rotation:"clockwise",moveInterval:100,cursor:"pointer",autoplay:!0},this.state={lastX:0,paused:!1,mouseDown:!1,isChrome:window.chrome},this.init=function(){t&&(this.setEl(t.el),this.setFps(t.fps),this.setFrames(t.frames),this.setRotation(t.rotation),this.setMoveInterval(t.moveInterval),this.setCursor(t.cursor),this.setAutoplay(t.autoplay)),this.setVideo(),this.initVideo(),this.tMove=this.throttle(this.move,this.options.moveInterval)},this.setEl=function(t){this.options.el=$("#"+t)},this.getEl=function(){if(null==this.options.el)throw new Error("el is not defined");return this.options.el},this.setVideo=function(){this.video=$("<video />")},this.setFps=function(t){void 0!==t&&(this.options.fps=t)},this.setFrames=function(t){void 0!==t&&(this.options.frames=t)},this.setRotation=function(t){("clockwise"==t||"counterclockwise"==t)&&(this.options.rotation=t)},this.setMoveInterval=function(t){void 0!==t&&(this.options.moveInterval=t)},this.setCursor=function(t){void 0!==t&&(this.options.cursor=t)},this.setAutoplay=function(t){void 0!==t&&(this.options.autoplay=t)},this.initVideo=function(){var t=this;this.video.attr("loop","loop"),this.video.css("cursor",t.options.cursor),this.video.on({loadedmetadata:function(){t.getEl().append(t.video),t.options.autoplay&&t.play()},mousedown:function(i){t.state.mouseDown=!0,t.state.lastX=i.pageX,t.pause()},mouseup:function(){t.state.mouseDown=!1,t.options.autoplay&&t.play()},mouseout:function(){t.state.mouseDown=!1,t.options.autoplay&&t.play()},mousemove:function(i){return t.state.mouseDown&&(i.pageX>t.state.lastX&&t.tMove("backward"),i.pageX<t.state.lastX&&t.tMove("forward"),t.state.lastX=i.pageX),!1}});var i=this.getEl().attr("data-src");this.video.attr("src",i)},this.getForwardTime=function(t){var i=this.getCurrentFrame()+1,e=this.getFrameTime(),o=this.getSemiFrameTime(),s=e*i+o;return s>t.duration?o:s},this.moveForward=function(){var t=this.video.get(0);t.currentTime=this.getForwardTime(t)},this.getBackwardTime=function(t){var i=this.getCurrentFrame()-1,e=this.getFrameTime(),o=this.getSemiFrameTime(),s=e*i;return 0>s?this.state.isChrome?t.duration-e-o:t.duration-o:s+o},this.getFrameTime=function(){return 1/this.options.fps},this.getSemiFrameTime=function(){return this.getFrameTime()/2},this.moveBackward=function(){var t=this.video.get(0);t.currentTime=this.getBackwardTime(t)},this.forward=function(){this.move("forward")},this.backward=function(){this.move("backward")},this.move=function(t){"counterclockwise"==this.options.rotation&&(t="forward"==t?"backward":"forward"),"forward"==t?this.moveForward():this.moveBackward()},this.play=function(){this.video.get(0).play()},this.pause=function(){this.video.get(0).pause()},this.isPaused=function(){return this.video.get(0).paused},this.getCurrentFrame=function(){return Math.floor(this.video.get(0).currentTime*this.options.fps)},this.now=Date.now||function(){return(new Date).getTime()},this.throttle=function(t,i,e){var o,s,n,r=null,a=0;e||(e={});var u=this,h=function(){a=e.leading===!1?0:u.now(),r=null,n=t.apply(o,s),r||(o=s=null)};return function(){var l=u.now();a||e.leading!==!1||(a=l);var c=i-(l-a);return o=this,s=arguments,0>=c||c>i?(clearTimeout(r),r=null,a=l,n=t.apply(o,s),r||(o=s=null)):r||e.trailing===!1||(r=setTimeout(h,c)),n}}};